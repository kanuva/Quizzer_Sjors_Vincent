
<div class="flex-wrapper-master">
  <div class="flex-container z-depth-2">
    <div class="row">
      <div class="col s12">
        <div class="title-box">
          <h1>QuizMaster</h1>
          <button onclick="testfunctie()">Testfunctie</button>
        </div>
        <div class="content-box">
          <div class="row">
            <div class="col s3 scores">
              <div class="title-box">
                <h4>Score</h4>
              </div>
              <!-- TEAM WITH SCORE WILL APPEND HERE -->
            </div>

            <div class="col s6">
              <div class="title-box">
                <h4>Content</h4>
              </div>

              <div>
                <p> Question: {{masterQuestion}}</p>
                <p> Answer:   {{masterAnswer}}</p>
              </div>
            </div>

            <div class="col s3">
              <div class="title-box">
                <h4>Questions</h4>
              </div>

              <div class="row card-holder">
                <div class="col s12">
                  <div class="card" ng-repeat="q in getQuestions" ng-click="selectQuestion(q)">
                    <div class="card-content">
                      <p style="color: #000;">{{ q.question }}</p>
                    </div>
                    <div class="card-action"><a>categorie: {{ q.category }}</a></div>
                  </div>
                </div>
              </div>
            </div>

          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="popup" style="display: none;">
  </div>

  <div class="modal">
    <div class="modal-content">
      <h4>Create a new room</h4>
      <form>
        <label for="roompassword"></label>
        <input id="roompassword" type="text" name="name" placeholder="Type here..." id="teamname"/>
      </form>
    </div>
    <div class="modal-footer">
      <button type="button" onclick="closeModal(document.getElementById('roompassword').value)" class="waves-effect btn-flat">agree</button>
    </div>
  </div>
</div>
<script type="text/javascript">

  $(window).resize(function() {
    var totalHeight = $(window).height();
    var offsetTop   = $('.card-holder').offset().top;

    $('.card-holder').css('height', ((totalHeight - offsetTop) - 15));
  });

  $(document).ready(function() {
    var totalHeight = $(window).height();
    var offsetTop   = $('.card-holder').offset().top;

    $('.card-holder').css('height', ((totalHeight - offsetTop) - 15));
  });



  $('body').removeAttr('style');
  $('body').css({ 'background-image' : "url(/assets/images/grey_wash_wall.png)" });
  var socket = io.connect(document.location.protocol+'//'+document.location.host);

  console.log(document.location.protocol + '//' + document.location.host);
  $('.modal').openModal({
    dismissible: false
  });
  
  $("input#roompassword").keyup(function(event){
    if(event.keyCode == 13){
        $("button").click();
    }
  });

  socket.on('nieuweclient', function(data){
    console.log("er is een nieuwe client met als teamnaam: " + data.Teamname);
    addTeam(data.Teamname, null);


    $('.popup').append('\
      <div class="popup-content" id="'+ data.Teamname +'">\
          <span> Mag het team '+ data.Teamname +' joinen?</span>\
          <input type="hidden" id="teamname" value="'+ data.Teamname +'"/>\
          <button onclick="acceptTeam(this)" class="agree">Agree</button>\
          <button onclick="declineTeam(this)" class="decline">Decline</button>\
      </div>\
    ');

    $('.popup').show();
  });

  socket.on('testttt', function() {
    console.log("ik heb zojuist mijn eigen testfunctie binnen gekregen");
  });

  socket.on('questionPull', function() {
    console.log('i got myself');
  });

  function addTeam(name, score) {
    if(score === undefined || score === null) { score = 0; }
    $(".content-box .row .col.s3.scores").append("<div class='row'><div class='col s6'><p> " + name + "</p></div><div class='col s6'><p>" + score + "</p></div></div>");
  }

  function acceptTeam(data) {


    console.log($(data).parent().attr('id'));
    $(data).parent().hide();
    $('.popup').hide();

  }

  function testfunctie() {
    socket.emit('testfunctie', "helloooooo");
    console.log("testfunctie");
  }

  function closeModal(roompassword) {
    CreateRoom(roompassword);
    $('.modal').closeModal();
  }

  function CreateRoom(roompassword) {
    socket.emit('create', roompassword);
    console.log(roompassword);
  }
</script>